<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CS2 Smoke Finder - –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Courier New', monospace; 
            background: #0a0e14; 
            color: #e8edf5; 
            padding: 20px; 
        }
        .container { max-width: 800px; margin: 0 auto; }
        .header { 
            text-align: center; 
            margin-bottom: 30px; 
            padding-bottom: 15px;
            border-bottom: 2px solid #00ff7a;
        }
        h1 { color: #00ff7a; margin-bottom: 10px; }
        .panel { 
            background: #12151b; 
            padding: 20px; 
            border-radius: 8px;
            border: 1px solid rgba(0, 255, 122, 0.2);
            margin-bottom: 20px;
        }
        .input-group { margin-bottom: 15px; }
        label { 
            display: block; 
            margin-bottom: 8px; 
            color: #8b949e; 
            font-size: 14px; 
        }
        input, select, button {
            width: 100%;
            padding: 10px;
            background: #1a1f29;
            border: 1px solid rgba(0, 255, 122, 0.2);
            border-radius: 4px;
            color: #e8edf5;
            font-family: inherit;
        }
        button {
            background: #00ff7a;
            color: #000;
            border: none;
            font-weight: bold;
            cursor: pointer;
            margin-top: 10px;
        }
        button:hover { opacity: 0.9; }
        .result {
            background: #1a1f29;
            padding: 15px;
            border-radius: 4px;
            margin-top: 20px;
            font-size: 13px;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }
        .log { 
            background: #000; 
            padding: 10px; 
            margin-top: 10px;
            border-radius: 4px;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>‚öôÔ∏è CS2 Smoke Finder - –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</h1>
            <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–∏—Å–∫–æ–º —Å–º–æ–∫–æ–≤ —á–µ—Ä–µ–∑ Python –±—ç–∫–µ–Ω–¥</p>
        </div>

        <div class="panel">
            <h3>üéØ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞</h3>
            <div class="input-group">
                <label>–¶–µ–ª–µ–≤–∞—è –ø–æ–∑–∏—Ü–∏—è (X, Y, Z):</label>
                <input type="text" id="targetPos" value="15, 10, 0">
            </div>
            <div class="input-group">
                <label>–¢–∏–ø –±—Ä–æ—Å–∫–∞:</label>
                <select id="throwType">
                    <option value="LEFT_CLICK">–õ–ö–ú (—Å–∏–ª—å–Ω—ã–π)</option>
                    <option value="BOTH_CLICKS">–û–±–∞ –∫–ª–∏–∫–∞ (—Å—Ä–µ–¥–Ω–∏–π)</option>
                    <option value="RIGHT_CLICK">–ü–ö–ú (—Å–ª–∞–±—ã–π)</option>
                </select>
            </div>
            <div class="input-group">
                <label>–°—Ç—Ä–∞—Ç–µ–≥–∏—è –ø–æ–∏—Å–∫–∞:</label>
                <select id="strategy">
                    <option value="GRID_SEARCH">–°–µ—Ç–æ—á–Ω—ã–π –ø–æ–∏—Å–∫</option>
                    <option value="GENETIC" selected>–ì–µ–Ω–µ—Ç–∏—á–µ—Å–∫–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º</option>
                    <option value="HYBRID">–ì–∏–±—Ä–∏–¥–Ω—ã–π</option>
                </select>
            </div>
            <button id="findBtn">üîç –ù–∞—á–∞—Ç—å –ø–æ–∏—Å–∫ —Å–º–æ–∫–æ–≤</button>
        </div>

        <div class="panel">
            <h3>üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã</h3>
            <div class="result" id="result">
                –ù–∞–∂–º–∏—Ç–µ "–ù–∞—á–∞—Ç—å –ø–æ–∏—Å–∫" —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã...
            </div>
        </div>

        <div class="panel">
            <h3>üìù –õ–æ–≥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</h3>
            <div class="log" id="log"></div>
        </div>
    </div>

    <script>
        const API_URL = 'http://localhost:5000';  // Flask —Å–µ—Ä–≤–µ—Ä
        
        function addLog(message) {
            const log = document.getElementById('log');
            log.innerHTML += `[${new Date().toLocaleTimeString()}] ${message}\n`;
            log.scrollTop = log.scrollHeight;
        }

        async function findSmokes() {
            const targetPos = document.getElementById('targetPos').value;
            const throwType = document.getElementById('throwType').value;
            const strategy = document.getElementById('strategy').value;
            
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '‚è≥ –ò–¥–µ—Ç –ø–æ–∏—Å–∫...';
            
            try {
                addLog(`–ü–æ–∏—Å–∫ —Å–º–æ–∫–æ–≤ –¥–ª—è —Ü–µ–ª–∏: ${targetPos}`);
                
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ Flask —Å–µ—Ä–≤–µ—Ä
                const response = await fetch(`${API_URL}/find_smokes`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        target_pos: targetPos.split(',').map(Number),
                        throw_type: throwType,
                        strategy: strategy
                    })
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                
                if (data.smokes && data.smokes.length > 0) {
                    let html = `‚úÖ –ù–∞–π–¥–µ–Ω–æ ${data.smokes.length} —Å–º–æ–∫–æ–≤:\n\n`;
                    
                    data.smokes.forEach((smoke, index) => {
                        html += `üéØ –°–º–æ–∫ #${index + 1}:\n`;
                        html += `   ‚Ä¢ –¢–æ—á–Ω–æ—Å—Ç—å: ${smoke.accuracy.toFixed(2)}–º\n`;
                        html += `   ‚Ä¢ –ü–æ–∑–∏—Ü–∏—è: [${smoke.throw_position.map(v => v.toFixed(1)).join(', ')}]\n`;
                        html += `   ‚Ä¢ –£–≥–ª—ã: Pitch=${smoke.angles.pitch.toFixed(1)}¬∞, Yaw=${smoke.angles.yaw.toFixed(1)}¬∞\n`;
                        html += `   ‚Ä¢ –ö–æ–º–∞–Ω–¥–∞: ${smoke.cs2_commands?.combined || 'N/A'}\n\n`;
                    });
                    
                    resultDiv.innerHTML = html;
                    addLog(`–ü–æ–∏—Å–∫ –∑–∞–≤–µ—Ä—à–µ–Ω: –Ω–∞–π–¥–µ–Ω–æ ${data.smokes.length} —Å–º–æ–∫–æ–≤`);
                } else {
                    resultDiv.innerHTML = '‚ùå –°–º–æ–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã';
                    addLog('–°–º–æ–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã');
                }
                
            } catch (error) {
                resultDiv.innerHTML = `‚ùå –û—à–∏–±–∫–∞: ${error.message}`;
                addLog(`–û—à–∏–±–∫–∞: ${error.message}`);
                console.error('Error:', error);
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.getElementById('findBtn').addEventListener('click', findSmokes);
        addLog('–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ');
        addLog(`API —Å–µ—Ä–≤–µ—Ä: ${API_URL}`);
        
        // –ê–≤—Ç–æ–ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        fetch(`${API_URL}/health`)
            .then(res => res.ok ? addLog('‚úÖ –°–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω') : addLog('‚ö†Ô∏è –°–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω'))
            .catch(() => addLog('‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É'));
    </script>
</body>
</html>